<!DOCTYPE html>
<html>

<head>

    <title>WebGL 3D Model Viewer Using three.js</title>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://sxia2.github.io/waist_project/Program4/three.js"></script>
    <script src="https://sxia2.github.io/waist_project/Program4/Detector.js"></script>
    <script src="https://sxia2.github.io/waist_project/Program4/OrbitControls.js"></script>
    <script src="https://sxia2.github.io/waist_project/Program4/GLTFLoader.js"></script>
    <script src="https://sxia2.github.io/waist_project/Program4/MTLLoader.js"></script>

    <style>
        .myDiv {
            border: 5px outset red;
            background-color: lightblue;
            text-align: center;
        }

        table,
        th,
        td {
            border: 1px solid black;
        }
    </style>
</head>

<body>
    <table>
        <tr>
            <th>
                <p>Month</p>
            </th>
            <th>
                <p>Month</p>
            </th>
        </tr>
        <tr>
            <td>
                <p>Month</p>
            </td>
            <td id="webgl-container"> </td>
        </tr>
        <tr>
            <td>
                <p>Month</p>
            </td>
            <td>
                <p>Month</p>
            </td>
        </tr>
    </table>

    <script>

        if (!Detector.webgl) {
            Detector.addGetWebGLMessage();
        }

        var container;

        var camera, controls, scene, renderer;
        var lighting, ambient, keyLight, fillLight, backLight;

        init();
        animate();

        function init() {

            container = document.getElementById("webgl-container")
            // document.body.appendChild(container);

            /* Camera */

            camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 1000);
            camera.position.z = 3;

            /* Scene */

            scene = new THREE.Scene();
            lighting = true;

            ambient = new THREE.AmbientLight(0xffffff, 1.0);
            scene.add(ambient);

            keyLight = new THREE.DirectionalLight(new THREE.Color('hsl(30, 100%, 75%)'), 1.0);
            keyLight.position.set(-100, 0, 100);

            fillLight = new THREE.DirectionalLight(new THREE.Color('hsl(240, 100%, 75%)'), 0.75);
            fillLight.position.set(100, 0, 100);

            backLight = new THREE.DirectionalLight(0xffffff, 1.0);
            backLight.position.set(100, 0, -100).normalize();

            // var objLoader = new THREE.OBJLoader();

            // material = new THREE.MeshStandardMaterial({

            //     color: 0xffffff,
            //     roughness: 1.0,
            //     metalness: 0.0,
            //     map = null,
            //     lightMap = null,
            //     lightMapIntensity = 1.0,
            //     aoMap = null,
            //     aoMapIntensity = 1.0,
            //     emissive = new Color(0x000000),
            //     emissiveIntensity = 1.0,
            //     emissiveMap = null,
            //     bumpMap = null,
            //     bumpScale = 1,
            //     normalMap = null,
            //     normalMapType = TangentSpaceNormalMap,
            //     normalScale = new Vector2( 1, 1 ),
            //     displacementMap = null,
            //     displacementScale = 1,
            //     displacementBias = 0,
            //     roughnessMap = null,


            //     // normalMap: normalMap,
            //     // normalScale: 1,

            //     // aoMap: 1,
            //     // aoMapIntensity: 1,

            //     // displacementMap: displacementMap,
            //     // displacementScale: settings.displacementScale,
            //     // displacementBias: - 0.428408, // from original model

            //     // envMap: reflectionCube,
            //     // envMapIntensity: settings.envMapIntensity,

            //     // side: THREE.DoubleSide

            // });

            // // objLoader.setMaterials(mirrorMaterial);
            // objLoader.load('https://sxia2.github.io//waist_project/SS%20Female.obj', function (object) {
            //     // const geometry = object.children[0].geometry;
            //     // geometry.attributes.uv2 = geometry.attributes.uv;
            //     // geometry.center();

            //     // mesh = new THREE.Mesh(geometry, material);
            //     // mesh.scale.multiplyScalar(25);
            //     scene.add(object);

            // });

            const loader = new GLTFLoader();
            loader.load(
                // resource URL
                'https://sxia2.github.io//waist_project/SS%20Female0.glb',
                // called when the resource is loaded
                function (gltf) {

                    scene.add(gltf.scene);

                    // gltf.animations; // Array<THREE.AnimationClip>
                    // gltf.scene; // THREE.Group
                    // gltf.scenes; // Array<THREE.Group>
                    // gltf.cameras; // Array<THREE.Camera>
                    // gltf.asset; // Object

                // },
                // // called while loading is progressing
                // function (xhr) {

                //     console.log((xhr.loaded / xhr.total * 100) + '% loaded');

                // },
                // // called when loading has errors
                // function (error) {

                //     console.log('An error happened');

                }
            );

            /* Renderer */

            renderer = new THREE.WebGLRenderer();
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(new THREE.Color("hsl(10, 10%, 10%)"));

            container.appendChild(renderer.domElement);

            /* Controls */

            controls = new THREE.OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.25;
            controls.enableZoom = false;

            /* Events */

            window.addEventListener('resize', onWindowResize, false);
            window.addEventListener('keydown', onKeyboardEvent, false);

        }

        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();

            renderer.setSize(window.innerWidth, window.innerHeight);

        }

        function onKeyboardEvent(e) {

            if (e.code === 'KeyL') {

                lighting = !lighting;

                if (lighting) {

                    ambient.intensity = 0.25;
                    scene.add(keyLight);
                    scene.add(fillLight);
                    scene.add(backLight);

                } else {

                    ambient.intensity = 1.0;
                    scene.remove(keyLight);
                    scene.remove(fillLight);
                    scene.remove(backLight);

                }

            }

        }

        function animate() {

            requestAnimationFrame(animate);

            controls.update();

            render();

        }

        function render() {

            renderer.render(scene, camera);

        }

    </script>
</body>

</html>